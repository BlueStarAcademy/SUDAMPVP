<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>SUDAM - 대기실</title>
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/waitingRoom.css">
</head>
<body class="<%= (typeof roomType !== 'undefined' && roomType === 'casual') ? 'room-type-casual' : '' %>">
    <%- include('partials/header', { user: user }) %>

    <!-- 프로필 모달 -->
    <%- include('partials/profileModal') %>

    <!-- 공지사항 모달 -->
    <%- include('partials/noticeModal') %>

    <!-- 통계 모달 -->
    <%- include('partials/waitingRoom/modals/statsModal') %>

    <!-- 프로필 수정 모달 -->
    <%- include('partials/waitingRoom/modals/profileEditModal') %>

    <!-- 대국 신청/AI 설정 통합 모달 -->
    <%- include('partials/waitingRoom/modals/gameRequestModal') %>

    <!-- 대국 신청 수신 모달 -->
    <%- include('partials/waitingRoom/modals/gameResponseModal') %>
    
    <!-- 미래 기능 모달들 -->
    <%- include('partials/waitingRoom/modals/shopModal') %>
    <%- include('partials/waitingRoom/modals/questModal') %>
    <%- include('partials/waitingRoom/modals/mailboxModal') %>
    <%- include('partials/waitingRoom/modals/settingsModal') %>

    <!-- 모바일 컴포넌트 -->
    <%- include('partials/waitingRoom/components/mobilePageIndicator') %>
    
    <div class="container">
        <!-- 전광판 -->
        <%- include('partials/waitingRoom/components/noticeBoard') %>
        
        <!-- 모바일 스와이프 컨테이너 -->
        <%- include('partials/waitingRoom/components/mobileSwipeContainer') %>
        
        <!-- 모바일 사이드바 -->
        <%- include('partials/waitingRoom/components/mobileSidebar') %>

        <!-- 메인 그리드 (PC용) -->
        <div class="waiting-room-grid">
            <!-- 프로필 및 레이팅 매칭 -->
            <%- include('partials/waitingRoom/panels/profilePanel', { user: user, roomType: typeof roomType !== 'undefined' ? roomType : 'strategy' }) %>

            <!-- 대국중인 경기장 -->
            <%- include('partials/waitingRoom/panels/ongoingGamesPanel', { roomType: typeof roomType !== 'undefined' ? roomType : 'strategy' }) %>

            <!-- 접속중인 유저 -->
            <%- include('partials/waitingRoom/panels/onlineUsersPanel') %>

            <!-- 랭킹보드 -->
            <%- include('partials/waitingRoom/panels/rankingBoardPanel') %>

            <!-- 채팅창 -->
            <%- include('partials/waitingRoom/panels/chatPanel') %>
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/modal.js"></script>
    <script src="/js/profileModal.js"></script>
    <script>
        // EJS 변수를 window 객체로 전달
        window.WAITING_ROOM_CONFIG = {
            userId: '<%= user.id %>',
            userNickname: '<%= user.nickname %>',
            roomType: '<%= typeof roomType !== "undefined" ? roomType : "strategy" %>',
            userGem: <%= user.gem || 0 %>
        };
    </script>
    <script src="/js/waitingRoom.js"></script>
</body>
</html>

