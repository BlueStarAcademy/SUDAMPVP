    <div id="profileEditModal" class="stats-modal">
        <div class="stats-modal-content" style="max-width: 600px;">
            <div class="stats-modal-header" id="profileEditModalHeader">
                <div class="stats-modal-title">프로필 수정</div>
                <button class="close-modal" onclick="closeProfileEditModal()">&times;</button>
            </div>
            <div class="stats-modal-body" style="padding: 30px;">
                <!-- 아바타 변경 -->
                <div class="profile-edit-section">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 15px; color: #333;">아바타 변경</h3>
                    <div class="avatar-selector-grid" id="avatarSelectorGrid" style="display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; max-height: 300px; overflow-y: auto; padding: 10px; background: #f5f5f5; border-radius: 8px;">
                        <!-- 아바타 선택 버튼들이 JavaScript로 동적으로 생성됩니다 -->
                    </div>
                </div>

                <!-- 닉네임 변경 -->
                <div class="profile-edit-section" style="margin-top: 30px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 15px; color: #333;">닉네임 변경</h3>
                    <div style="display: flex; gap: 12px; align-items: center;">
                        <input type="text" id="newNicknameInput" class="form-input" placeholder="새 닉네임" value="<%= user.nickname %>" style="flex: 1; padding: 12px 16px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 14px; transition: all 0.3s; background: #fff; box-shadow: 0 2px 4px rgba(0,0,0,0.05);" onfocus="this.style.borderColor='#667eea'; this.style.boxShadow='0 4px 8px rgba(102, 126, 234, 0.15)';" onblur="this.style.borderColor='#e0e0e0'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.05)';">
                        <button class="gem-btn" onclick="changeNickname()" style="white-space: nowrap; display: inline-flex; align-items: center; gap: 6px; padding: 12px 20px; font-size: 14px; font-weight: 600;">
                            <span>변경</span>
                            <img src="/images/Zem.webp" alt="젬" style="width: 18px; height: 18px; object-fit: contain;" onerror="this.style.display='none';">
                            <span>100</span>
                        </button>
                    </div>
                </div>

                <!-- MBTI 설정 -->
                <div class="profile-edit-section" style="margin-top: 30px;">
                    <h3 style="font-size: 16px; font-weight: 700; margin-bottom: 15px; color: #333;">바둑MBTI 설정</h3>
                    <% if (user.badukMBTI) { %>
                        <div style="margin-bottom: 15px; padding: 12px; background: #f0f9ff; border: 1px solid #bae6fd; border-radius: 8px;">
                            <div style="font-size: 14px; color: #0369a1; font-weight: 600;">현재 바둑MBTI: <span id="currentMBTI"><%= user.badukMBTI %></span></div>
                        </div>
                    <% } %>
                    <button class="btn btn-primary" onclick="startMBTIQuiz()" style="width: 100%; padding: 12px; font-size: 14px; font-weight: 600;">
                        <%= user.badukMBTI ? '바둑MBTI 재설정하기' : '바둑MBTI 설정하기' %>
                    </button>
                    <div style="font-size: 12px; color: #666; margin-top: 8px; text-align: center;">처음 설정 시 100젬 필요</div>
                    
                    <!-- MBTI 퀴즈 모달 -->
                    <div id="mbtiQuizModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; align-items: center; justify-content: center;">
                        <div style="background: white; border-radius: 16px; padding: 30px; max-width: 600px; width: 90%; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3);">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                                <h2 style="font-size: 20px; font-weight: 700; color: #333; margin: 0;">바둑MBTI 퀴즈</h2>
                                <button onclick="closeMBTIQuiz()" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">&times;</button>
                            </div>
                            
                            <!-- 진행 상태 -->
                            <div style="margin-bottom: 25px;">
                                <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                    <span style="font-size: 14px; color: #666;">진행 <span id="mbtiQuizProgress">1</span>/4</span>
                                    <span style="font-size: 14px; color: #667eea; font-weight: 600;"><span id="mbtiQuizPercent">25</span>%</span>
                                </div>
                                <div style="height: 6px; background: #e5e7eb; border-radius: 3px; overflow: hidden;">
                                    <div id="mbtiQuizProgressBar" style="height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 100%); width: 25%; transition: width 0.3s;"></div>
                                </div>
                            </div>
                            
                            <!-- 퀴즈 내용 선택지 -->
                            <div id="mbtiQuizContent">
                                <!-- 퀴즈 내용이 JavaScript로 동적으로 로드됩니다 -->
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
